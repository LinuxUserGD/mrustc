--- a/vendor/rustix-0.38.44/build.rs
+++ b/vendor/rustix-0.38.44/build.rs
@@ -29,7 +29,7 @@ fn main() {

     // Check for `--features=use-libc`. This allows crate users to enable the
     // libc backend.
-    let feature_use_libc = var("CARGO_FEATURE_USE_LIBC").is_ok();
+    let feature_use_libc = true;

     // Check for `RUSTFLAGS=--cfg=rustix_use_libc`. This allows end users to
     // enable the libc backend even if rustix is depended on transitively.
--- a/vendor/rustix-1.0.5/build.rs
+++ b/vendor/rustix-1.0.5/build.rs
@@ -29,7 +29,7 @@ fn main() {

     // Check for `--features=use-libc`. This allows crate users to enable the
     // libc backend.
-    let feature_use_libc = var("CARGO_FEATURE_USE_LIBC").is_ok();
+    let feature_use_libc = true;

     // Check for `RUSTFLAGS=--cfg=rustix_use_libc`. This allows end users to
     // enable the libc backend even if rustix is depended on transitively.
--- a/vendor/rustix-1.0.7/build.rs
+++ b/vendor/rustix-1.0.7/build.rs
@@ -29,7 +29,7 @@ fn main() {

     // Check for `--features=use-libc`. This allows crate users to enable the
     // libc backend.
-    let feature_use_libc = var("CARGO_FEATURE_USE_LIBC").is_ok();
+    let feature_use_libc = true;

     // Check for `RUSTFLAGS=--cfg=rustix_use_libc`. This allows end users to
     // enable the libc backend even if rustix is depended on transitively.
--- a/vendor/rustix-1.0.8/build.rs
+++ b/vendor/rustix-1.0.8/build.rs
@@ -29,7 +29,7 @@ fn main() {

     // Check for `--features=use-libc`. This allows crate users to enable the
     // libc backend.
-    let feature_use_libc = var("CARGO_FEATURE_USE_LIBC").is_ok();
+    let feature_use_libc = true;

     // Check for `RUSTFLAGS=--cfg=rustix_use_libc`. This allows end users to
     // enable the libc backend even if rustix is depended on transitively.
--- compiler/rustc_hir/src/hir.rs
+++ compiler/rustc_hir/src/hir.rs
@@ -4938,4 +4938,5 @@
 // Some nodes are used a lot. Make sure they don't unintentionally get bigger.
+#[cfg(not(rust_compiler="mrustc"))]
 #[cfg(target_pointer_width = "64")]
 mod size_asserts {
     use rustc_data_structures::static_assert_size;
--- compiler/rustc_errors/src/lib.rs
+++ compiler/rustc_errors/src/lib.rs
@@ -102,5 +102,6 @@
 // `PResult` is used a lot. Make sure it doesn't unintentionally get bigger.
 #[cfg(target_pointer_width = "64")]
 rustc_data_structures::static_assert_size!(PResult<'_, ()>, 24);
+#[cfg(not(rust_compiler="mrustc"))]
 #[cfg(target_pointer_width = "64")]
 rustc_data_structures::static_assert_size!(PResult<'_, bool>, 24);
--- compiler/rustc_parse/src/parser/mod.rs
+++ compiler/rustc_parse/src/parser/mod.rs
@@ -229,3 +229,4 @@
 // though, because `TokenTypeSet(u128)` alignment varies on others, changing the total size.
+#[cfg(not(rust_compiler="mrustc"))]
 #[cfg(all(target_pointer_width = "64", any(target_arch = "aarch64", target_arch = "x86_64")))]
 rustc_data_structures::static_assert_size!(Parser<'_>, 288);
--- compiler/rustc_middle/src/ty/sty.rs
+++ compiler/rustc_middle/src/ty/sty.rs
@@ -2026,4 +2026,4 @@
 impl<'tcx> rustc_type_ir::inherent::Tys<TyCtxt<'tcx>> for &'tcx ty::List<Ty<'tcx>> {
     fn inputs(self) -> &'tcx [Ty<'tcx>] {
-        self.split_last().unwrap().1
+        (**self).split_last().unwrap().1
     }
--- compiler/rustc_middle/src/ty/generic_args.rs
+++ compiler/rustc_middle/src/ty/generic_args.rs
@@ -703,7 +703,7 @@
 impl<'tcx, T: TypeVisitable<TyCtxt<'tcx>>> TypeVisitable<TyCtxt<'tcx>> for &'tcx ty::List<T> {
     #[inline]
     fn visit_with<V: TypeVisitor<TyCtxt<'tcx>>>(&self, visitor: &mut V) -> V::Result {
-        walk_visitable_list!(visitor, self.iter());
+        walk_visitable_list!(visitor, (***self).iter());
         V::Result::output()
     }
 }
